<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36 Edg/138.0.0.0" version="28.0.9">
  <diagram name="AWS MongoDB Lambda Architecture" id="aws-mongo-lambda">
    <mxGraphModel dx="3045" dy="820" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="aws-cloud" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="-100" y="50" width="1310" height="770" as="geometry" />
        </mxCell>
        <mxCell id="aws-label" value="AWS Cloud (us-east-1)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="70" y="60" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="vpc" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="-50" y="120" width="1220" height="670" as="geometry" />
        </mxCell>
        <mxCell id="vpc-label" value="VPC: mongo-vpc&#xa;CIDR: 10.0.0.0/16" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="120" y="130" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="igw" value="Internet Gateway&#xa;mongo-igw" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="500" y="80" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="subnet" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;dashed=1;" parent="1" vertex="1">
          <mxGeometry y="200" width="1140" height="540" as="geometry" />
        </mxCell>
        <mxCell id="subnet-label" value="Public Subnet: mongo-subnet&#xa;CIDR: 10.0.1.0/24&#xa;AZ: us-east-1a" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="10" y="230" width="200" height="50" as="geometry" />
        </mxCell>
        <mxCell id="route-table" value="Route Table&#xa;mongo-rt&#xa;&#xa;Routes:&#xa;10.0.0.0/16 → Local&#xa;0.0.0.0/0 → IGW" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="260" y="210" width="110" height="80" as="geometry" />
        </mxCell>
        <mxCell id="ec2" value="EC2 Instance&#xa;mongo-server&#xa;&#xa;Type: t2.micro (Free Tier)&#xa;OS: Ubuntu 20.04&#xa;MongoDB: 6.0&#xa;&#xa;Private IP: 10.0.1.x&#xa;Public IP: Dynamic" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="400" y="300" width="180" height="120" as="geometry" />
        </mxCell>
        <mxCell id="mongodb" value="MongoDB&#xa;Port: 27017&#xa;&#xa;Database: testdb&#xa;Collection: testcol" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="450" y="530" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="lambda" value="Lambda Function&#xa;mongo-client&#xa;&#xa;Runtime: Python 3.9&#xa;Handler: lambda_function.lambda_handler&#xa;Timeout: 30s&#xa;&#xa;Environment:&#xa;MONGO_HOST=10.0.1.x" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="700" y="250" width="180" height="170" as="geometry" />
        </mxCell>
        <mxCell id="lambda-layer" value="Lambda Layer&#xa;pymongo&#xa;&#xa;Runtime: Python 3.9&#xa;Dependencies:&#xa;- pymongo library" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="700" y="570" width="170" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sg-ec2" value="Security Group&#xa;mongo-ec2-sg&#xa;&#xa;Inbound:&#xa;• SSH (22) from 0.0.0.0/0&#xa;• MongoDB (27017) from Lambda SG&#xa;&#xa;Outbound:&#xa;• All traffic" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="80" y="310" width="150" height="110" as="geometry" />
        </mxCell>
        <mxCell id="sg-lambda" value="Security Group&#xa;mongo-lambda-sg&#xa;&#xa;Inbound:&#xa;• None&#xa;&#xa;Outbound:&#xa;• All traffic" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="970" y="290" width="150" height="90" as="geometry" />
        </mxCell>
        <mxCell id="iam-role" value="IAM Role&#xa;mongo-lambda-role&#xa;&#xa;Policies:&#xa;• AWSLambdaVPCAccessExecutionRole&#xa;&#xa;Allows Lambda to:&#xa;• Create ENI in VPC&#xa;• Write CloudWatch logs" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="930" y="540" width="180" height="110" as="geometry" />
        </mxCell>
        <mxCell id="keypair" value="Key Pair&#xa;mongo-key&#xa;&#xa;SSH Access to EC2" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="290" y="540" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="user" value="Developer/User&#xa;&#xa;Invokes Lambda via:&#xa;• AWS Console&#xa;• AWS CLI&#xa;• SDK&#xa;• API Gateway (optional)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=10;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="730" y="10" width="120" height="100" as="geometry" />
        </mxCell>
        <mxCell id="internet-connection" value="Internet" style="ellipse;shape=cloud;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;" parent="1" vertex="1">
          <mxGeometry x="520" y="10" width="80" height="50" as="geometry" />
        </mxCell>
        <mxCell id="conn1" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#666666;" parent="1" source="internet-connection" target="igw" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="560" y="70" as="sourcePoint" />
            <mxPoint x="560" y="90" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn2" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#d79b00;" parent="1" target="route-table" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="530.0047058823527" y="140" as="sourcePoint" />
            <mxPoint x="383.24" y="241.8367346938776" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn3" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#d79b00;" parent="1" source="route-table" target="ec2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="290" y="320" as="sourcePoint" />
            <mxPoint x="400" y="360" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn4" value="localhost:27017" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#82b366;" parent="1" source="ec2" target="mongodb" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="490" y="420" as="sourcePoint" />
            <mxPoint x="490" y="440" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn5" value="10.0.1.x:27017&#xa;(Private Network)" style="endArrow=classic;html=1;rounded=0;strokeWidth=3;strokeColor=#d6b656;" parent="1" source="lambda" target="mongodb" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="700" y="380" as="sourcePoint" />
            <mxPoint x="530" y="480" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn6" value="Attached" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#9673a6;dashed=1;" parent="1" source="lambda-layer" target="lambda" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="780" y="440" as="sourcePoint" />
            <mxPoint x="780" y="420" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn7" value="Assumes" style="endArrow=classic;html=1;rounded=0;strokeWidth=2;strokeColor=#9673a6;dashed=1;" parent="1" source="iam-role" target="lambda" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="780" y="550" as="sourcePoint" />
            <mxPoint x="780" y="420" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn8" value="Invokes&#xa;(Manual/API)" style="endArrow=classic;html=1;rounded=0;strokeWidth=3;strokeColor=#666666;" parent="1" source="user" target="lambda" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="170" y="350" as="sourcePoint" />
            <mxPoint x="700" y="360" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn9" value="Applied to" style="endArrow=classic;html=1;rounded=0;strokeWidth=1;strokeColor=#b85450;dashed=1;" parent="1" source="sg-ec2" target="ec2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="350" y="430" as="sourcePoint" />
            <mxPoint x="400" y="360" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn10" value="Applied to" style="endArrow=classic;html=1;rounded=0;strokeWidth=1;strokeColor=#b85450;dashed=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="sg-lambda" target="lambda" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="350" y="509.00990099009914" as="sourcePoint" />
            <mxPoint x="700.0000000000002" y="387.72277227722793" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="conn11" value="SSH Access" style="endArrow=classic;html=1;rounded=0;strokeWidth=1;strokeColor=#82b366;dashed=1;" parent="1" source="keypair" target="ec2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="450" y="550" as="sourcePoint" />
            <mxPoint x="490" y="420" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="outputs" value="Terraform Outputs:&#xa;&#xa;• ec2_public_ip: Dynamic Public IP&#xa;• ec2_private_ip: 10.0.1.x&#xa;• lambda_function_name: mongo-client" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=10;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="890" y="10" width="200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="flow1" value="1. User invokes Lambda" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" parent="1" vertex="1">
          <mxGeometry x="380" y="250" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="flow2" value="2. Lambda connects to MongoDB&#xa;via private network" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" parent="1" vertex="1">
          <mxGeometry x="580" y="345" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="flow3" value="3. MongoDB operations&#xa;(insert/find/update/delete)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" parent="1" vertex="1">
          <mxGeometry x="550" y="520" width="120" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
